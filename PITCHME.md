# Web Python

@fa[code fa-3x]

Веб приложения на Python. Flask и другие фреймворки.

> Часть первая

Note:

- Надо сделать тестовый рассказ и определиться, что войдёт в первую лекцию,
а что придётся сдвинуть
- какие интерактивные примеры можно привести, где разместить их в повествовании,
в каком формате подготовить

---

## Содержание

@ul

- Веб приложения
- Фреймворки
- Flask
- Django
- Deployment
- Микросервисы
- Практическое задание

@ulend

Note:

Для начала рассмотрим что из себя представляют веб приложение в целом;
какие бывают архитектурные и концептуальные подходы и т.п.

- Заострить внимание на применении и структуре приложений
- Какие из них мы рассмотрим подробней, на примере фреймворков питона
- Добавить NOTA BENE после каждой темы, с краткими выводами

---

## Веб

- Общая идея
- Какие бывают приложения
- Архитектура

---

### Веб приложение это

Приложение, в котором клиент взаимодействует с сервером при помощи браузера.

@ul
- клиентская часть реализует пользовательский интерфейс, формирует запросы к серверу и обрабатывает ответы от него
- серверная часть получает запрос от клиента, выполняет требуемые действия, формирует ответ
@ulend

Note:

- обозначить понятия фронтенд и бэкенд
- немного про то, как это появилось и развивается

---

### Классическая схема

![Legacy Web app](img/1-web-app.png)

Note:

Клиент обращается к приложению, которое генерирует в ответ статический html

---

### Асинхронные виджеты

![Widgets](img/2-web-app.png)

Note:

Отдельные элементы на странице обновляются асинхронно, через особые
взаимодействия с бэкендом

---

### Single Page Application

![SPA](img/3-web-app.png)

Note:

- фронтенд и бэкенд существуют отдельно друг от друга
- потенциально, бэкенд (или фронтенд) можно полностью заменить на другой, без
особых проблем
---

### Общая схема

![Web application at a glance](img/4-web-app.png)

Note:

- может включать в себя очень много чего
- в лекциях будем рассматривать преимущественно само "приложение"
- но также затронем и остальные моменты

---

### Веб приложения. Nota bene

@ul

- Frontend это HTML, CSS, JS - интерфейс для пользователя
- Backend предоставляет "интерфейс" для фронтенда
- На деле всё бывает достаточно туманно
- Последние тенденции как сближают, так и разделяют эти два компонента веб приложений

@ulend

Note:

Необходимо подвести к разделению на frontend/backend и рассказать подробней о
грани (или её отсутствии) между ними.

---

## Инструментарий

- Встроенные модули питона
- Flask
- Django
- Прочие (Bottle, Pyramids, Tornado)

---

### HTTP server

Доступен "из коробки", реализован на основе `socketserver.TCPServer`

> python -m http.server 8000

---?code=src/1-http-server.py&lang=py&color=white&title=Http server

@[1-2]
@[3-5]
@[7](Назначим свою версию обработчика HTTP запросов)
@[9-11](Переопределяем метод GET)
@[13](Модифицируем стартовую директорию)
@[15-16](Запускаем сервер с нашим HTTP обработчиком)


Note:
- по умолчанию раздаёт текущую директорию или файл index.html
- модифицируем текущую директорию и метод GET

---

## Flask

@ul

- Установка и конфигурация
- Структура проекта
- Готовые модули
- Blueprints

@ulend

Note:

- почему Flask это микро-фреймворк
- Flask как проект-шутка (немного об истории)
- что включает в себя Flask

---

### Flask. Окружение

```bash
pip intall pipenv

pipenv install flask

pipenv shell
```

Note:

- для данного приложения задействуем виртуальное окружение
- дальше рассмотрим альтернативные варианты создания development окружения

---

<!-- ### Flask. Простое приложение -->

---?code=src/flask/1-simple.py&lang=py&color=white&title=Flask. Простое приложение
@[1](Импортируем необходимые модули)
@[3](Создаём приложение)
@[5-7](Назначаем маршрут 'Hello World')
@[9-11](Добавляем редирект с корневого url)
@[13-14]

---?code=src/flask/2-template.py&lang=py&color=white&title=Flask. Добавляем шаблон
@[5](Обозначим данные)
@[9](Выведем данные в шаблон)

---?code=src/flask/templates/fish.html&lang=html&color=white&title=Flask. Добавляем шаблон
@[1,2,12](Это HTML, а то вдруг кто перепутает)
@[3-5](Назовём нашу страничку)
@[6-11](Выведем в цикле всех рыбок)

Note:

- файлы шаблонов надо где-то хранить
- шаблонизаторы и что это такое

---

### Flask. Структура проекта

---

### Flask. Готовые модули

---


### Flask. Blueprints


---

## Django

@ul

- В чём отличие
- Установка и модули
- Консольная утилита
- Структура приложения
- База данных и миграции

@ulend

---

## Django. Вступление

---

## Django. Создание проекта

---

## Django. Консольная утилита

---

## Django. Структура приложения

---

## Django. База данных, модели, миграции

---

## Deployment

@ul

- Gunicorn, wsgi
- Сервер nginx, reverse proxy
- Supervisor, systemd

@ulend

---

## Заключение

@ul

- Frontend + backend
- Типы приложений
- Микросервисы

@ulend

---

## Практика
---

### Задача #1.

Http-прокси сервер, запускаемый локально и отображающий
содержимое произвольного сайта, с одной лишь только разницей: после каждого
слова из 10 букв должен стоять значок trademark, он же ™.

**Hard mode**: приложение должно запускаться как консольная утилита с
некоторыми параметрами, на усмотрение автора (к примеру: целевой сайт, порт
прокси и т.п.)

---

### Задача #1. Инструментарий

- Git
- Virtualenv/Pipenv
- Bottle
- Requests
- BeautifulSoup
- Click

---

### Задача #2.

@css[justified](
Приложение позволяющее отправить через веб-форму некоторый текст, выдающее на
его основе набор комбинаций сформированных через марковские цепи.)

@color[lightgray](
**Hard mode**: исходные данные и результирующие комбинации должны храниться в
базе данных и быть доступны для просмотра через некую историю сабмитов.)

---

### Задача #2. Инструментарий

- Git
- Virtualenv/Pipenv
- Flask/Django
- Sqlite
- Markovify

---

## Ссылки

Данная презентация
https://gitpitch.com/xifax/lectures-python-web/master

Репозиторий презентации
https://github.com/xifax/lectures-python-web
